<!DOCTYPE html>
<html lang="es">

<head>

<meta charset="UTF-8">
<title>Sistema de Stock</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>

body{
background:#f5f5f5;
}

.sidebar{
height:100vh;
background:#343a40;
color:white;
}

.sidebar a{
color:white;
text-decoration:none;
display:block;
padding:12px;
}

.sidebar a:hover{
background:#495057;
}

.card{
border:none;
box-shadow:0 2px 5px rgba(0,0,0,0.1);
}

</style>

</head>


<body>

<div class="container-fluid">

<div class="row">

<!-- SIDEBAR -->

<div class="col-2 sidebar">

<h4 class="p-3">Stock</h4>

<a href="#" onclick="mostrarDashboard()">Dashboard</a>
<a href="#" onclick="mostrarProductos()">Productos</a>
<a href="#" onclick="mostrarVentas()">Ventas</a>

</div>



<!-- CONTENIDO -->

<div class="col-10 p-4">

<div id="contenido">

<h2>Dashboard</h2>

<div class="row mt-4">

<div class="col-md-4">

<div class="card bg-warning text-white">
<div class="card-body">

<h5>Ventas hoy</h5>
<h3 id="ventasHoy">$0</h3>

</div>
</div>

</div>

<div class="col-md-4">

<div class="card bg-primary text-white">
<div class="card-body">

<h5>Productos</h5>
<h3 id="totalProductos">0</h3>

</div>
</div>

</div>

<div class="col-md-4">

<div class="card bg-danger text-white">
<div class="card-body">

<h5>Stock bajo</h5>
<h3 id="stockBajo">0</h3>

</div>
</div>

</div>

</div>

</div>

</div>

</div>

</div>


<script>

const supabaseUrl = "TU_URL"
const supabaseKey = "TU_KEY"

const client = supabase.createClient(supabaseUrl,supabaseKey)



async function mostrarDashboard(){

document.getElementById("contenido").innerHTML = `
<h2>Dashboard</h2>

<div class="row mt-4">

<div class="col-md-4">
<div class="card bg-warning text-white">
<div class="card-body">
<h5>Ventas hoy</h5>
<h3 id="ventasHoy">$0</h3>
</div>
</div>
</div>

<div class="col-md-4">
<div class="card bg-primary text-white">
<div class="card-body">
<h5>Productos</h5>
<h3 id="totalProductos">0</h3>
</div>
</div>
</div>

<div class="col-md-4">
<div class="card bg-danger text-white">
<div class="card-body">
<h5>Stock bajo</h5>
<h3 id="stockBajo">0</h3>
</div>
</div>
</div>

</div>
`

calcularDashboard()

}



async function calcularDashboard(){

// total productos

const { data:productos } = await client
.from("productos")
.select("*")

document.getElementById("totalProductos").textContent = productos.length



// stock bajo

let bajo = productos.filter(p=>p.stock <= p.stock_minimo)

document.getElementById("stockBajo").textContent = bajo.length



// ventas hoy

const { data:ventas } = await client
.from("ventas")
.select("*")

let total = 0

let hoy = new Date()
hoy.setHours(0,0,0,0)

ventas.forEach(v=>{

if(new Date(v.fecha) >= hoy){

total += v.precio

}

})

document.getElementById("ventasHoy").textContent = "$"+total

}



</script>

</body>
</html>

